@using Protov4.DTO;
@model List<CarritoFullDTO> 

@{
    ViewData["Title"] = "Home Page";
}

    <p class="Titulo1"> Tienes @Model.Count articulos en tu carrito</p>

    <table class="TabCarrito">
    <tr >
        <th>Producto</th>
        <th></th>
        <th>Precio</th>
        <th>Cantidad</th>
        <th>Subtotal</th>
        <th>btn</th>
    </tr>

    @foreach (var carr in Model)
    {int cantidad = 1;
        byte[] imagenBytes = carr.Imagen;
        string base64 = "data:image/png;base64," + Convert.ToBase64String(imagenBytes);
        <tr>
        <td class="ColImag"><img src="@base64" width="200" height="200"></td>
        <td class="ColImag"> @carr.Nombre_Producto </td>
        <td class="ColPrec">$ @carr.Precio </td>
            <td class="ColCant">
                <button class="btn bi bi-dash-lg btnmenoscarrito"></button>
                <h4 class="contador">1</h4>
                <button class="btn bi bi-plus-lg btnmas"></button>
            </td>
        <td class="ColSubT">$ @carr.subtotal_producto </td>
            <td class="ColElim">
                <button class="btn btn-outline-light" style="background-color: #474972;">
                    <i class="bi bi-trash3"></i>
                </button>
            </td>
        </tr>
        //<img src="@base64" width="267" height="252">
        //<p> @carr.Nombre_Producto </p>
        //<p> @carr.Precio </p>
        //<p> @carr.cantidad </p>
        //<p> @carr.subtotal_producto </p>
    }
</table>

<div class="total">
    <h1>Total Carrito</h1>
    @{
        decimal total=0;
        @foreach (var item in Model)
        {
            total = total + item.subtotal_producto;
        }
        <h3>
           $ @total
        </h3>
    }
</div>



<script>
    $(document).ready(function () {
        // Manejar clic en el botón de menos
        $(".btnmenos").on("click", function () {
            var divProducto = $(this).closest(".product-info");
            var cantidadElement = divProducto.find(".contador");
            var cantidad = parseInt(cantidadElement.text());
            if (cantidad > 1) {
                cantidad--;
                cantidadElement.text(cantidad);
            }
        });

        // Manejar clic en el botón de más
        $(".btnmas").on("click", function () {
            var divProducto = $(this).closest(".product-info");
            var cantidadElement = divProducto.find(".contador");
            var cantidad = parseInt(cantidadElement.text());
            cantidad++;
            cantidadElement.text(cantidad);
        });
    });
</script>
